<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8">
  <title>3D Modell – Cesium</title>

  <!-- Cesium JS och Widgets CSS -->
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Widgets/widgets.css" rel="stylesheet">

  <!-- Cesium Measurement Widget CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/johnkpaul/cesium-measure@v1.1.1/dist/cesium-measure.css" />

  <!-- Lightbox CSS för bilder -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.15.0/simple-lightbox.min.css" />

  <style>
    html, body, #cesiumContainer { width:100%; height:100%; margin:0; padding:0; }
    /* Toolbar längst ner i mitten */
    .cesium-viewer .cesium-viewer-toolbar {
      bottom: 10px !important;
      top: auto !important;
      left: 50% !important;
      transform: translateX(-50%);
    }
    /* Inspektionsbilder */
    #inspektionsbilder {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 10px;
      max-width: 300px;
      overflow-y: auto;
      max-height: 400px;
      font-family: sans-serif;
      z-index: 100;
    }
    #inspektionsbilder img {
      width: 100px;
      margin: 3px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="cesiumContainer"></div>

<!-- Inspektionsbilder -->
<div id="inspektionsbilder">
  <b>Inspektionsbilder:</b><br>
  <!-- Bilder läggs in via JS -->
</div>

<!-- Cesium Measurement Widget JS -->
<script src="https://cdn.jsdelivr.net/gh/johnkpaul/cesium-measure@v1.1.1/dist/cesium-measure.js"></script>

<!-- Lightbox JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.15.0/simple-lightbox.min.js"></script>

<script>
  // Din Cesium access token
  Cesium.Ion.defaultAccessToken = "DIN_TOKEN_HÄR"; // <-- byt till din token

  // Skapa Cesium Viewer
  const viewer = new Cesium.Viewer("cesiumContainer", {
    timeline: false,
    animation: false,
    baseLayerPicker: false,
    sceneModePicker: true,
    navigationHelpButton: true, // visar kompassen
    homeButton: true,
    infoBox: true,
    selectionIndicator: true,
    skyBox: false,
    skyAtmosphere: false,
    imageryProvider: false, // vit bakgrund
    backgroundColor: Cesium.Color.WHITE
  });

  // Din 3D-modell
  const assetId = DIN_ASSETID_HÄR; // <-- byt till din assetId
  Cesium.Cesium3DTileset.fromIonAssetId(assetId)
    .then(tileset => {
      viewer.scene.primitives.add(tileset);

      const bs = tileset.boundingSphere;

      // Zooma ut lite och titta ner på modellen
      viewer.camera.viewBoundingSphere(bs, new Cesium.HeadingPitchRange(0, -0.3, bs.radius * 1.5));

      // Home-knapp centrerad på modellen
      viewer.homeButton.viewModel.command.beforeExecute.addEventListener(e => {
        e.cancel = true;
        viewer.camera.viewBoundingSphere(bs, new Cesium.HeadingPitchRange(0, -0.3, bs.radius * 1.5));
      });

      // Rotera runt egen mittpunkt (valfritt)
      // viewer.scene.preRender.addEventListener(() => {
      //   viewer.camera.rotate(Cesium.Cartesian3.UNIT_Z, 0.001);
      // });
    });

  // =========================
  // Lägg till mätverktyg (Cesium Measurement Widget)
  // =========================
  const measureWidget = new Cesium.Measure(viewer, {
    autoActivateDistance: false,
    autoActivateArea: false,
    autoActivateAngle: false
  });

  // Placera widget toolbar längst ner
  viewer.container.appendChild(measureWidget.container);
  measureWidget.container.style.position = "absolute";
  measureWidget.container.style.bottom = "10px";
  measureWidget.container.style.left = "50%";
  measureWidget.container.style.transform = "translateX(-50%)";
  measureWidget.container.style.zIndex = "100";

  // =========================
  // Lägg in inspektionsbilder
  // =========================
  const container = document.getElementById('inspektionsbilder');
  const antalBilder = 87; // ändra efter behov
  for (let i=1; i<=antalBilder; i++){
    const link = document.createElement('a');
    link.href = `images/inspektion${i}.jpg`;
    link.className = "lightbox";
    const img = document.createElement('img');
    img.src = `images/inspektion${i}.jpg`;
    link.appendChild(img);
    container.appendChild(link);
  }

  // Initiera lightbox
  new SimpleLightbox('.lightbox', { /* options */ });
</script>

</body>
</html>
